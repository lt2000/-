# a非线性方程求解

## 迭代法

### 实根的对分法

* $f(a)f(b)<0$，则存在x~0~属于(a,b),使得$f(x_0)=0$
* 结束条件:|xk+1 − xk | < e1 or |f(xk+1)| < e2
* 算法简单，只要求f连续
* 收敛速度慢，**只能求一个根**，精度有限

### 不动点迭代

* 步骤

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112141538106.png" alt="image-20210112141538106" style="zoom:67%;" />

* 如何构造迭代格式，使迭代格式收敛？

  * 满足压缩映射定理
  * <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112142205148.png" alt="image-20210112142205148" style="zoom:67%;" />

* 迭代格式的收敛是否与初值x~0~相关？

  * **有关**

## Newton迭代

1. 对$f(x)=0$的牛顿迭代格式为

   $x_{k+1}=x_k-\frac{f(x_k)}{f(x_k)'}$

2. 将非线性方程反复线性化(泰勒展开)，再用线性方程的解逼近非线性方程的解

3. **将初值选为靠近精确解的值，估计**

### 收敛阶

1. 定义

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112144230599.png" alt="image-20210112144230599" style="zoom:67%;" />
   
2. 当不动点不是迭代函数的导数的根时为一阶收敛

3. 当不动点是迭代函数的导数的根，不是其二阶导数的根时为二阶收敛

### 牛顿迭代收敛阶

1. α为单根时，牛顿迭代二阶收敛，α为重根时，牛顿迭代一阶收敛
2. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112145118223.png" alt="image-20210112145118223" style="zoom:67%;" />

3. 求迭代格式时α的几阶方法？
   * 首先验证迭代格式的极限是α
   * 然后利用迭代格式将$x_{k+1}-\alpha$表示成$x_{k}-\alpha$的幂

### 优缺

* 格式简单，收敛速度快

* 与初值密切相关，初值不好可能不收敛

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112145739716.png" alt="image-20210112145739716" style="zoom:67%;" />

## 弦截法

1. 定义

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112145930341.png" alt="image-20210112145930341" style="zoom:67%;" />

## 非线性方程组的Newton迭代法

  ### 二元方程组

1. 雅克比矩阵

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112150655396.png" alt="image-20210112150655396" style="zoom:67%;" />

2. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112150715312.png" alt="image-20210112150715312" style="zoom:67%;" />

3. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112150741847.png" alt="image-20210112150741847" style="zoom:67%;" />



# 解线性方程组的直接法

* 准确可靠，理论上可以得到精确解

* 三种特例

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112152057878.png" alt="image-20210112152057878"  />

## 高斯消元法

### 高斯顺序消元法

1. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112152618776.png" alt="image-20210112152618776" style="zoom:67%;" />
2. 理论上可行的充要条件<=>A的所有顺序主子式不为零
3. **O(n^3^)**
4. 如果$a_{kk}^{(k)}$很小，会导致较大的计算误差

### 高斯列主元消元法

* 改进

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112153240530.png" alt="image-20210112153240530" style="zoom:67%;" />

### 高斯乔丹消元法

* 高斯消元后再打洞成为对角阵

## 直接分解法

* 主要思想

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112180947331.png" alt="image-20210112180947331" style="zoom:67%;" />

* L、U是三角阵

### Doolittle分解

1. L是单位下三角阵

2. 分解过程

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112181307397.png" alt="image-20210112181307397" style="zoom:67%;" />

3. 计算U的第k行元素

   $$u_{kj}=a_{kj}-\sum_{r=1}^{k-1}l_{kr}u_{rj}$$

4. 计算L的第j列元素

   $$l_{ik}=(a_{ik}-\sum_{r=1}^{k-1}l_{ir}u_{rk})/u_{kk}$$

### Crout 分解

1. U是单位上三角阵

2. 分解过程

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112183007722.png" alt="image-20210112183007722" style="zoom:67%;" />

3. 计算U的第k行元素

   $$u_{kj}=(a_{kj}-\sum_{r=1}^{k-1}l_{kr}u_{rj})/l_{kk}$$

4. 计算L的第j列元素

   $$l_{ik}=a_{ik}-\sum_{r=1}^{k-1}l_{ir}u_{rk})$$

### 特殊线性方程组

#### 三对角阵的追赶法

* 求解过程

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112184324768.png" alt="image-20210112184324768" style="zoom:67%;" />

* **O(5N)**

#### 对称正定矩阵的LDL^T^的分解

1. 求解过程

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112185509252.png" alt="image-20210112185509252" style="zoom:67%;" />

2. 由于分解成三部分，因此求解过程有三步

## 范数

### 向量范数

1. 定义

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112185746737.png" alt="image-20210112185746737" style="zoom:67%;" />

### 矩阵范数

1. 定义

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112190422614.png" alt="image-20210112190422614" style="zoom:67%;" />

2. 1范数-列模和最大值 无穷范数-行模和最大值

3. 矩阵的特征值小于等于所有范数

4. 佛罗贝尼乌斯范数

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112191027971.png" alt="image-20210112191027971" style="zoom:67%;" />

### 条件数和病态矩阵

1. 条件数定义

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112191207347.png" alt="image-20210112191207347" style="zoom:67%;" />

2. 条件数可以认为误差放大倍数

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112191425946.png" alt="image-20210112191425946" style="zoom:67%;" />![image-20210112191439790](C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112191439790.png)

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112191425946.png" alt="image-20210112191425946" style="zoom:67%;" />![image-20210112191439790](C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112191439790.png)

# 解线性方程组的迭代法

* 求解步骤

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112192303535.png" alt="image-20210112192303535" style="zoom:67%;" />

* **向量序列收敛的充要条件是谱半径小于一，通常用范数来估计**

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112192431541.png" alt="image-20210112192431541" style="zoom:67%;" />
  
* **收敛与初值的选取无关**

## Jacobi迭代

1. 计算过程

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112194314011.png" alt="image-20210112194314011" style="zoom:67%;" />

2. 向量形式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112194547279.png" alt="image-20210112194547279" style="zoom:67%;" />

3. 一些收敛的充分条件

   * 初始的矩阵A严格行对角占优和列对角占优

     <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112194943809.png" alt="image-20210112194943809" style="zoom:67%;" />

4. **对角线元素全都不为零，否则调整方程次序**

## Gauss-Seidel迭代

1. 计算过程，在Jaocbi迭代中，使用新计算出的分量

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112195527042.png" alt="image-20210112195527042" style="zoom:67%;" />

2. 向量形式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112195636404.png" alt="image-20210112195636404" style="zoom:67%;" />

3. 若矩阵严格对角占优，则M可逆

4. 收敛的一些充分条件

   * A为严格对角占优矩阵
   * A为实对称正定矩阵

5. 通过迭代矩阵G==（不是A）==的谱半径判断是否收敛

## 松弛（SOR）迭代

1. 在Gauss-Seidel的基础上引进松弛因子w

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112201308008.png" alt="image-20210112201308008" style="zoom:67%;" />

2. 向量形式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112201353974.png" alt="image-20210112201353974" style="zoom:67%;" />

3. 收敛条件

   * 松弛迭代收敛->0<w<2
   * A为对称正定矩阵，则0<w<2时松弛收敛

## 小结

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112201711265.png" alt="image-20210112201711265" style="zoom:67%;" />

# 数值积分和数值微分

## 牛顿科特斯数值积分

1. 数值积分：有限离散节点上的函数值的某种线性组合

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112202342651.png" alt="image-20210112202342651" style="zoom:67%;" />

2. 代数精度

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112202540524.png" alt="image-20210112202540524" style="zoom:67%;" />

3. 插值型数值积分

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112202921806.png" alt="image-20210112202921806" style="zoom:67%;" />

4. 牛顿科特斯积分（**积分节点选择等距节点**）

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112205348844.png" alt="image-20210112205348844" style="zoom:67%;" />

5. n = 1时为梯形公式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112205444335.png" alt="image-20210112205444335" style="zoom:67%;" />

6. n = 2时为Simpson公式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112205609820.png" alt="image-20210112205609820" style="zoom:67%;" />

7. 误差

   * 梯形公式：$E_1(f)=\frac{-(b-a)^3}{12}f(\zeta)''$   一阶代数精度
   * Simpson公式：$E_2(f)=\frac{(b-a)^5}{2880}f(\zeta)''''$  三阶代数精度

8. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112210245888.png" alt="image-20210112210245888" style="zoom:67%;" />

## 复化数值积分

* 分段，每段内使用低阶数值积分

### 复化梯形公式

1. 公式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112210845347.png" alt="image-20210112210845347" style="zoom: 67%;" />

2. 积分误差

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112210928739.png" alt="image-20210112210928739" style="zoom:67%;" />

3. 截断误差$ O(h^2)$

### 复化Simpson公式

1. 计算公式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112211117728.png" alt="image-20210112211117728" style="zoom:67%;" />

2. 积分误差

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112211146669.png" alt="image-20210112211146669" style="zoom:67%;" />

3. 截断误差 $O(h^4)$

## 复化积分的自动控制误差计算

* 在复化积分中需要根据误差公式选取适当的n，满足精度要求

* 复化梯形

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112212157980.png" alt="image-20210112212157980" style="zoom:80%;" />

* 复化Simpson

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112212221023.png" alt="image-20210112212221023" style="zoom:80%;" />

## Romberg积分

* 

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112212943396.png" alt="image-20210112212943396" style="zoom:67%;" />

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112213002641.png" alt="image-20210112213002641" style="zoom:67%;" />

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112213022390.png" alt="image-20210112213022390" style="zoom:67%;" />

## 重积分

。。。。。。

## Gauss积分

* 对m个积分节点的插值型数值积分公式，一般至少可达到m-1阶代数精度
* 固定节点个数n，代数精度最高的公式为2n-1阶，**意味着插值积分节点要精心选取，不再是等距**

### 高斯积分构造方法

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112214602205.png" alt="image-20210112214602205" style="zoom:67%;" />

1. 正交化方法

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112214938269.png" alt="image-20210112214938269" style="zoom:67%;" />

2. 计算积分节点

3. $l_i(x)$是以积分节点为插值节点的拉格朗日插值函数

4. 求高斯积分公式，代数精度为2n-1

5. 积分误差为

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112215400049.png" alt="image-20210112215400049" style="zoom:67%;" />

### 高斯勒让德积分 W(x)=1

* <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112215625333.png" alt="image-20210112215625333" style="zoom:67%;" />
* <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112215734892.png" alt="image-20210112215734892" style="zoom:67%;" />

## 数值微分

### 向前差商

1. 公式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220043081.png" alt="image-20210112220043081" style="zoom:67%;" />

2. 误差==由泰勒展开得到==

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220132324.png" alt="image-20210112220132324" style="zoom:67%;" />

### 向后差商

1. 公式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220220730.png" alt="image-20210112220220730" style="zoom:67%;" />

2. 误差

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220317673.png" alt="image-20210112220317673" style="zoom:67%;" />

### 中间差商

1. 公式

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220402810.png" alt="image-20210112220402810" style="zoom:67%;" />

2. 误差

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220421082.png" alt="image-20210112220421082" style="zoom:67%;" />

### 插值型数值微分

1. 得到插值函数后，求导
2. ==泰勒展开求误差主项==
3. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220716925.png" alt="image-20210112220716925" style="zoom:67%;" />
4. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210112220730656.png" alt="image-20210112220730656" style="zoom:67%;" />

# 常微分方程数值解

* 初值问题

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113160400303.png" alt="image-20210113160400303" style="zoom:67%;" />
  
* 基本概念：数值解、格点函数、差分方程

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113160638123.png" alt="image-20210113160638123" style="zoom:67%;" />

* 收敛性、误差推导、稳定性

## Euler公式

* 基于数值微分建立差分格式

### 向前Euler公式

* 一步显式格式

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113161157281.png" alt="image-20210113161157281" style="zoom:67%;" />

###  向后Euler公式

* 一步隐式格式，需要用迭代法求解$y_{n+1}$

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113161451303.png" alt="image-20210113161451303" style="zoom:67%;" />

### 中心Euler公式

* 二步二阶格式，不稳定
* <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113162055582.png" alt="image-20210113162055582" style="zoom:67%;" />

## 局部截断误差--泰勒展开求解

* 定义

  <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113162322271.png" alt="image-20210113162322271" style="zoom:67%;" />

* 向前向后Euler都是一阶的，中心Euler是二阶的

## 梯形公式

* <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113162854572.png" alt="image-20210113162854572" style="zoom:67%;" />

## 基于数值积分的公式

### 改进的Euler公式

* <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113163211169.png" alt="image-20210113163211169" style="zoom:67%;" />

## 线性多步法

### 显式格式

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113164808025.png" alt="image-20210113164808025" style="zoom:67%;" />

### 隐式格式

* j从-1到q-1

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113165040547.png" alt="image-20210113165040547" style="zoom:67%;" />

### 两个控制参数p，q

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113165235752.png" alt="image-20210113165235752" style="zoom:67%;" />

* **积分区间求积分系数，积分系数相加等于积分区间的长度**
* 计算积分系数时可能用到：(x-a)(x-b)原函数为$(x-a)(x-b)^2/2-(x-b)^3/6$

### 截断误差

* 将差分格式中的$y_{n+1}$与$y(x_{n+1})$分别在$x_n$处泰勒展开（其他点也可以）
* 然后相减得到误差主项
* 精确值减去近似值

### 预估-校正公式

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113171243519.png" alt="image-20210113171243519" style="zoom:67%;" />

## Runge-Kutta

* 基于泰勒展开建立差分方程

### 二阶公式

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113183145870.png" alt="image-20210113183145870" style="zoom:67%;" />

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113183206982.png" alt="image-20210113183206982" style="zoom:67%;" />

* 局部截断误差为$O(h^3)$

### 三阶、四阶

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113183435522.png" alt="image-20210113183435522" style="zoom:67%;" />

## 方程组和高阶方程的数值解法

* 方程组:对每个方程应用前面的公式
* <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113184140830.png" alt="image-20210113184140830" style="zoom:67%;" />

## 常微分方程解的稳定性

课本

* **误差方程的特征方程的所有根绝对值均要小于1**

#  矩阵特征值与特征向量计算

## 幂法 按模最大特征值

1. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113190755059.png" alt="image-20210113190755059" style="zoom:67%;" />

2. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113190833301.png" alt="image-20210113190833301" style="zoom:67%;" />

3. ![image-20210113190900408](C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113190900408.png)

4. 算法描述

   <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113191038870.png" alt="image-20210113191038870" style="zoom:67%;" />

## 幂法的规范化运算

1. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113191402486.png" alt="image-20210113191402486" style="zoom:67%;" />
2. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113191504087.png" alt="image-20210113191504087" style="zoom:67%;" />

## 反幂法

<img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113191838543.png" alt="image-20210113191838543" style="zoom:67%;" />

### 实对称矩阵的Jacobi方法

1. 每次选取非对角线上最大的元素
2. <img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20210113192817601.png" alt="image-20210113192817601" style="zoom:67%;" />